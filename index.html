<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Solana Rug Checker (Better UI Demo)</title>
  <style>
    body {
      background-color: #121212;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 2rem;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    .title {
      font-size: 2rem;
      margin-bottom: 1rem;
      font-weight: bold;
    }
    .input-row {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .input-row input {
      flex: 1;
      padding: 0.5rem;
      background: #222;
      border: 1px solid #444;
      color: #fff;
      border-radius: 4px;
    }
    .input-row button {
      background: #27ae60;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      color: #fff;
      font-weight: bold;
    }
    .analysis-section {
      background: #1f1f1f;
      border: 1px solid #333;
      border-radius: 8px;
      padding: 1rem;
      margin-top: 2rem;
    }
    .analysis-section h2 {
      margin-top: 0;
      margin-bottom: 1rem;
    }
    .analysis-section .card {
      background: #2b2b2b;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      border: 1px solid #333;
    }
    .card h3 {
      margin: 0 0 0.5rem 0;
    }
    .card .risk-label {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-weight: bold;
    }
    .risk-low {
      background-color: #27ae60;
    }
    .risk-medium {
      background-color: #f39c12;
    }
    .risk-high {
      background-color: #c0392b;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">Solana Rug Checker</div>
    <div class="input-row">
      <input id="tokenAddress" placeholder="token address here" />
      <button id="checkBtn">Rug Check</button>
    </div>
    <div id="analysis" class="analysis-section" style="display: none;">
      <h2>Token Safety Analysis</h2>
      <div id="analysis-content"></div>
    </div>
  </div>

  <script>
    // WARNING: Exposes your API key publicly! Only use this for demos/testing.
    const HELIUS_URL = "https://mainnet.helius-rpc.com/?api-key=f7f694d9-993a-46ba-adbf-3e1ec4f29416";

    document.getElementById("checkBtn").addEventListener("click", async () => {
      const tokenAddress = document.getElementById("tokenAddress").value.trim();
      if (!tokenAddress) {
        alert("Please enter a token address");
        return;
      }

      // We'll do two calls:
      // 1) getTokenSupply       -> to get total supply
      // 2) getAccountInfo       -> to check freezeAuthority, mintAuthority
      // Then we do a basic "risk" check for demonstration.

      const supplyPayload = {
        jsonrpc: "2.0",
        id: 1,
        method: "getTokenSupply",
        params: [tokenAddress]
      };

      const accountInfoPayload = {
        jsonrpc: "2.0",
        id: 1,
        method: "getAccountInfo",
        params: [
          tokenAddress,
          { encoding: "jsonParsed" }
        ]
      };

      let supplyData, accountInfoData;
      try {
        // 1) Fetch token supply
        const supplyRes = await fetch(HELIUS_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(supplyPayload),
        });
        const supplyJson = await supplyRes.json();
        supplyData = supplyJson?.result?.value;

        // 2) Fetch account info (for authorities)
        const accountRes = await fetch(HELIUS_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(accountInfoPayload),
        });
        const accountJson = await accountRes.json();
        accountInfoData = accountJson?.result?.value?.data?.parsed?.info;
      } catch (error) {
        alert("Error fetching data from Helius: " + error.message);
        return;
      }

      // Extract data
      // e.g. supplyData might have: { amount: "9900000000", decimals: 9, uiAmount: 9.9, uiAmountString: "9.9" }
      const totalSupply = supplyData?.uiAmountString || "N/A";
      const freezeAuthority = accountInfoData?.freezeAuthority || null;
      const mintAuthority = accountInfoData?.mintAuthority || null;

      // Basic "risk" logic: if freeze or mint authority exist, label "Medium Risk"
      let riskLabel = "Low Risk";
      let riskClass = "risk-low";
      if (freezeAuthority || mintAuthority) {
        riskLabel = "Medium Risk";
        riskClass = "risk-medium";
      }
      // You can add more checks for a "High Risk" label if needed.

      // Show the analysis section
      document.getElementById("analysis").style.display = "block";

      // Render the data in a nice UI
      const contentDiv = document.getElementById("analysis-content");
      contentDiv.innerHTML = `
        <div class="card">
          <h3>Token Address</h3>
          <p>${tokenAddress}</p>
        </div>
        <div class="card">
          <h3>Supply</h3>
          <p>${totalSupply}</p>
        </div>
        <div class="card">
          <h3>Mint Authority</h3>
          <p>${mintAuthority ? mintAuthority : "None"}</p>
        </div>
        <div class="card">
          <h3>Freeze Authority</h3>
          <p>${freezeAuthority ? freezeAuthority : "None"}</p>
        </div>
        <div class="card">
          <h3>Risk Factors</h3>
          <span class="risk-label ${riskClass}">${riskLabel}</span>
        </div>
      `;
    });
  </script>
</body>
</html>
