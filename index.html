<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Solana Rug Checker (Helius)</title>
</head>
<body style="background:#111; color:#fff; font-family:sans-serif; display:flex; flex-direction:column; align-items:center; padding:20px;">
  <h1>Solana Rug Checker (using Helius RPC)</h1>
  <p>Enter a Solana address (token mint, associated token account, or wallet):</p>
  
  <div style="display:flex; gap:10px;">
    <input
      id="tokenAddress"
      type="text"
      placeholder="Enter any Solana address"
      style="padding:5px;"
    />
    <button onclick="checkToken()">Rug Check</button>
  </div>

  <div id="result" style="margin-top:20px; white-space:pre; font-family:monospace;"></div>

  <!-- Load the Solana Web3.js library from unpkg or jsDelivr -->
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>

  <script>
    // Replace with your personal Helius RPC endpoint:
    // e.g. "https://mainnet.helius-rpc.com/?api-key=YOUR_API_KEY"
    const RPC_ENDPOINT = "https://mainnet.helius-rpc.com/?api-key=f7f694d9-993a-46ba-adbf-3e1ec4f29416";

    async function checkToken() {
      const addressInput = document.getElementById('tokenAddress');
      const resultDiv = document.getElementById('result');
      const address = addressInput.value.trim();

      // Clear previous results
      resultDiv.textContent = "";

      if (!address) {
        alert('Please enter a Solana address!');
        return;
      }

      // Connect to Helius
      const connection = new solanaWeb3.Connection(RPC_ENDPOINT);

      try {
        const publicKey = new solanaWeb3.PublicKey(address);

        // Attempt getParsedAccountInfo first (works for SPL token mints & token accounts)
        const parsedInfo = await connection.getParsedAccountInfo(publicKey);

        if (parsedInfo.value) {
          const parsedData = parsedInfo.value.data;
          if (parsedData && parsedData.parsed) {
            // "type" can be "mint" (for a token mint) or "account" (for a token holding account)
            const accountType = parsedData.parsed.type || 'N/A';
            const info = parsedData.parsed.info || {};

            if (accountType === 'mint') {
              // Show mint details
              const mintAuthority   = info.mintAuthority   || 'None';
              const freezeAuthority = info.freezeAuthority || 'None';
              const decimals        = info.decimals;
              const supply          = info.supply;
              resultDiv.textContent =
                `SPL Token Mint Info:\n` +
                `Mint Authority:   ${mintAuthority}\n` +
                `Freeze Authority: ${freezeAuthority}\n` +
                `Decimals:         ${decimals}\n` +
                `Supply:           ${supply}`;
              return;
            } else if (accountType === 'account') {
              // This is a token holding account
              // Typically "info.owner" is the wallet that owns this token account
              const owner      = info.owner || 'N/A';
              const tokenAmount = info.tokenAmount;
              const amount     = tokenAmount?.amount;
              const decimals   = tokenAmount?.decimals;
              resultDiv.textContent =
                `SPL Token Account Info:\n` +
                `Owner (wallet): ${owner}\n` +
                `Balance:        ${amount}\n` +
                `Decimals:       ${decimals}`;
              return;
            } else {
              // Some other SPL token type
              resultDiv.textContent =
                `SPL Token Account Info:\nType: ${accountType}\n(No additional data)`;
              return;
            }
          }
        }

        // If we reach here, it's not a parsed SPL token or there's no data
        // So let's fetch raw info
        const rawInfo = await connection.getAccountInfo(publicKey);
        if (!rawInfo) {
          resultDiv.textContent = `No data found for ${address}.`;
          return;
        }

        const ownerProgram = rawInfo.owner.toBase58();
        const dataSize = rawInfo.data.length;
        const isExecutable = rawInfo.executable;
        resultDiv.textContent =
          `Raw Account Info:\n` +
          `Owner Program: ${ownerProgram}\n` +
          `Data Size:     ${dataSize} bytes\n` +
          `Executable:    ${isExecutable}`;
      } catch (error) {
        console.error(error);
        resultDiv.textContent = 'Error fetching token info. Check console.\n' + error;
      }
    }
  </script>
</body>
</html>
