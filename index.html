<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Solana Rug Checker (Helius)</title>
</head>
<body style="background:#111; color:#fff; font-family:sans-serif; display:flex; flex-direction:column; align-items:center; padding:20px;">
  <h1>Solana Rug Checker (using Helius RPC)</h1>
  <p>Enter a Solana address (token mint, associated token account, or wallet):</p>
  
  <div style="display:flex; gap:10px;">
    <input
      id="tokenAddress"
      type="text"
      placeholder="Enter any Solana address"
      style="padding:5px;"
    />
    <button onclick="checkToken()">Rug Check</button>
  </div>

  <div id="result" style="margin-top:20px; white-space:pre; font-family:monospace;"></div>

  <!-- 1) Load the Solana Web3.js library from a CDN -->
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  
  <script>
    // 2) Your personal Helius RPC endpoint:
    //    (You posted it publicly in the conversation, so be aware anyone can see/use it)
    const RPC_ENDPOINT = "https://mainnet.helius-rpc.com/?api-key=f7f694d9-993a-46ba-adbf-3e1ec4f29416";

    async function checkToken() {
      const addressInput = document.getElementById('tokenAddress');
      const resultDiv = document.getElementById('result');
      const address = addressInput.value.trim();

      // Clear previous results
      resultDiv.textContent = "";

      if (!address) {
        alert('Please enter a Solana address!');
        return;
      }

      // 3) Connect to Helius
      const connection = new solanaWeb3.Connection(RPC_ENDPOINT);

      try {
        const publicKey = new solanaWeb3.PublicKey(address);

        // 4) Attempt getParsedAccountInfo (works for SPL token mints or token accounts)
        const parsedInfo = await connection.getParsedAccountInfo(publicKey);
        
        if (parsedInfo.value) {
          const parsedData = parsedInfo.value.data;
          // If recognized as an SPL token
          if (parsedData && parsedData.parsed) {
            const owner = parsedData.parsed.info?.owner || 'N/A';
            const type  = parsedData.parsed.type || 'N/A';
            resultDiv.textContent = `SPL Token Account Info:\nOwner: ${owner}\nType: ${type}`;
            return;
          }
        }

        // 5) Fallback: get raw account info if not a parsed SPL token
        const rawInfo = await connection.getAccountInfo(publicKey);
        if (!rawInfo) {
          resultDiv.textContent = `No data found for ${address}.`;
          return;
        }

        const ownerProgram = rawInfo.owner.toBase58();
        const dataSize = rawInfo.data.length;
        const isExecutable = rawInfo.executable;
        resultDiv.textContent =
          `Raw Account Info:\n` +
          `Owner Program: ${ownerProgram}\n` +
          `Data Size: ${dataSize} bytes\n` +
          `Executable: ${isExecutable}`;
      } catch (error) {
        console.error(error);
        resultDiv.textContent = 'Error fetching token info. Check console.\n' + error;
      }
    }
  </script>
</body>
</html>
